{% extends 'layout.html' %}

{% block title %}
    Meditation
{% endblock %}

{% block content %}
  <h2>Meditation</h2>
  <div class="note">
    <div>
      <h3>Minutes: <input type="number" id="minutes" min="0" value="0"></h3>
      <h3>Seconds: <input type="number" id="seconds" min="0" max="59" value="0"></h3>
    </div>
    <div class="timer" id="timer">00:00</div>
    <div class="delete">
      <button onclick="startTimer()">Start</button>
      <button onclick="pauseTimer()">Pause</button>
      <button onclick="resetTimer()">Reset</button>
    </div>
  </div>
  <script>
    let countdown;
    let remainingTime = 0;

    function updateDisplay(time) {
      let mins = Math.floor(time / 60);
      let secs = time % 60;
      document.getElementById("timer").textContent =
        String(mins).padStart(2, '0') + ":" + String(secs).padStart(2, '0');
    }

    function startTimer() {
      if (countdown) return; // Prevent multiple intervals
      if (remainingTime === 0) {
        let mins = parseInt(document.getElementById("minutes").value) || 0;
        let secs = parseInt(document.getElementById("seconds").value) || 0;
        remainingTime = mins * 60 + secs;
      }
      updateDisplay(remainingTime);
      countdown = setInterval(() => {
        if (remainingTime <= 0) {
          clearInterval(countdown);
          countdown = null;
          alert("Time's up!");
        } else {
          remainingTime--;
          updateDisplay(remainingTime);
        }
      }, 1000);
    }

    function pauseTimer() {
      clearInterval(countdown);
      countdown = null;
    }

    function resetTimer() {
      clearInterval(countdown);
      countdown = null;
      remainingTime = 0;
      updateDisplay(0);
      document.getElementById("minutes").value = 0;
      document.getElementById("seconds").value = 0;
    }
  </script>
{% endblock %}